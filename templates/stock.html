<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>çµŒå–¶æˆ¦ç•¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='result.css') }}">

   <link rel="stylesheet" href="{{ url_for('static', filename='humbergur.css') }}">
  
</head>
  <header>
          <div id="menu-icon" class="menu-icon">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
          </div>
          <h1 style="margin: 0; font-size: 1.5em;">åœ¨åº«ãƒªã‚¹ãƒˆ</h1>

          <button id="back-to-top" class="back-to-top" title="ãƒšãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹">
            &#9650;
          </button>
    </header>

    <nav id="sidebar" class="sidebar">
          <ul>
              <li><a href="/">ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸</a></li>
              <li><a href="/dashboard">çµŒå–¶æˆ¦ç•¥</a></li>
              <li><a href="search.html">å€‹åˆ¥é¡§å®¢åˆ†æ</a></li>
              <li><a href="stock.html">åœ¨åº«ãƒªã‚¹ãƒˆ</a></li>
          </ul>
    </nav>

  <h2>åœ¨åº«ç‡10%æœªæº€ã®å•†å“ï¼ˆä¸Šä½5ä»¶ï¼‰</h2>
  <table>
    <thead>
      <tr>
        <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
        {% if 'itemname' in low_stock_risk[0] %}<th>å•†å“å</th>{% endif %}
        {% if 'itemcate' in low_stock_risk[0] %}<th>ã‚«ãƒ†ã‚´ãƒª</th>{% endif %}
        <th>ç·æ³¨æ–‡æ•°</th>
        <th>ç¾åœ¨åœ¨åº«</th>
        <th>åœ¨åº«ç‡</th>
      </tr>
    </thead>
    <tbody>
      {% for i in low_stock_risk %}
      <tr class="low-stock">
        <td>{{ i.itemcode }}</td>
        {% if 'itemname' in i %}<td>{{ i.itemname }}</td>{% endif %}
        {% if 'itemcate' in i %}<td>{{ i.itemcate }}</td>{% endif %}
        <td>{{ i.total_ordered|format_currency }}</td>
        <td>{{ i.current_stock|format_currency }}</td>
        <td>{{ ('%.1f' % (i.stock_ratio * 100)) }}%</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- ğŸ”¹ æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ä»˜ãï¼‰ -->
  <form method="get" action="/stock.html" class="search-form">
    <input type="text" name="itemcode" placeholder="å•†å“ã‚³ãƒ¼ãƒ‰" value="{{ search_params.itemcode }}">
    {% if 'itemname' in item_analysis[0] %}
      <input type="text" name="itemname" placeholder="å•†å“å" value="{{ search_params.itemname }}">
    {% endif %}
    {% if categories %}
      <select name="itemcate">
        <option value="">-- ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠ --</option>
        {% for cate in categories %}
          <option value="{{ cate }}" {% if search_params.itemcate == cate %}selected{% endif %}>{{ cate }}</option>
        {% endfor %}
      </select>
    {% endif %}
    <input type="number" step="0.01" name="min_stock_ratio" placeholder="æœ€å°åœ¨åº«ç‡(%)" value="{{ search_params.min_stock_ratio }}">
    <input type="number" step="0.01" name="max_stock_ratio" placeholder="æœ€å¤§åœ¨åº«ç‡(%)" value="{{ search_params.max_stock_ratio }}">
    <input type="number" name="min_ordered" placeholder="æœ€å°ç·æ³¨æ–‡æ•°" value="{{ search_params.min_ordered }}">
    <input type="number" name="max_ordered" placeholder="æœ€å¤§ç·æ³¨æ–‡æ•°" value="{{ search_params.max_ordered }}">
    <button type="submit">æ¤œç´¢</button>
  </form>

  <h2>å…¨å•†å“åœ¨åº«ä¸€è¦§</h2>
  <table>
    <thead>
      <tr>
        <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
        {% if 'itemname' in item_analysis[0] %}<th>å•†å“å</th>{% endif %}
        {% if 'itemcate' in item_analysis[0] %}<th>ã‚«ãƒ†ã‚´ãƒª</th>{% endif %}
        <th>ç·æ³¨æ–‡æ•°</th>
        <th>ç¾åœ¨åœ¨åº«</th>
        <th>åœ¨åº«ç‡</th>
      </tr>
    </thead>
    <tbody>
      {% for i in item_analysis %}
      <tr>
        <td>{{ i.itemcode }}</td>
        {% if 'itemname' in i %}<td>{{ i.itemname }}</td>{% endif %}
        {% if 'itemcate' in i %}<td>{{ i.itemcate }}</td>{% endif %}
        <td>{{ i.total_ordered|format_currency }}</td>
        <td>{{ i.current_stock|format_currency }}</td>
        <td>{{ ('%.1f' % (i.stock_ratio * 100)) }}%</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <script src="{{ url_for('static', filename='humbergur.js') }}"></script>
</body>
</html>