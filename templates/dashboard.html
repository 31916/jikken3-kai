<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>çµŒå–¶æˆ¦ç•¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='result.css') }}">

   <link rel="stylesheet" href="{{ url_for('static', filename='humberger.css') }}">
  
  
</head>
<body>
  <header>
        <div id="menu-icon" class="menu-icon">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
        <h1 style="margin: 0; font-size: 1.5em;">çµŒå–¶æˆ¦ç•¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
  </header>

  <nav id="sidebar" class="sidebar">
        <ul>
            <li><a href="/">ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸</a></li>
            <li><a href="/dashboard">çµŒå–¶æˆ¦ç•¥</a></li>
            <li><a href="search.html">é¡§å®¢IDæ¤œç´¢</a></li>
            <li><a href="stock.html">åœ¨åº«ãƒªã‚¹ãƒˆ</a></li>
        </ul>
  </nav>
   <h1>ğŸ“Š é¡§å®¢ãƒ»åœ¨åº«åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
    
    <h2>ğŸ” é¡§å®¢å±æ€§ãƒ•ã‚£ãƒ«ã‚¿</h2>
    <div class="filter-form">
        <form method="GET" action="">
            <label for="gender">æ€§åˆ¥:</label>
            <select name="gender" id="gender" style="padding: 5px;">
                <option value="">å…¨ã¦</option>
                <option value="1" {% if gender_filter == '1' %}selected{% endif %}>ç”·æ€§</option>
                <option value="2" {% if gender_filter == '2' %}selected{% endif %}>å¥³æ€§</option>
            </select>
            
            <label for="min_age">å¹´é½¢ (æœ€å°):</label>
            <input type="number" name="min_age" id="min_age" value="{{ min_age_filter if min_age_filter is not none else '' }}" min="0" style="width: 80px; padding: 5px;">
            
            <label for="max_age">å¹´é½¢ (æœ€å¤§):</label>
            <input type="number" name="max_age" id="max_age" value="{{ max_age_filter if max_age_filter is not none else '' }}" min="0" style="width: 80px; padding: 5px;">
            
            <button type="submit" style="padding: 6px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ / æ¤œç´¢</button>
            <button type="button" onclick="window.location.href='/'" style="padding: 6px 15px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">ãƒªã‚»ãƒƒãƒˆ</button>
        </form>
        
        <div class="filter-status">
            é©ç”¨ä¸­ã®æ¡ä»¶: 
            {% if gender_filter %}**æ€§åˆ¥**: {{ gender_filter }} {% endif %}
            {% if min_age_filter %}**æœ€å°å¹´é½¢**: {{ min_age_filter }}æ­³ {% endif %}
            {% if max_age_filter %}**æœ€å¤§å¹´é½¢**: {{ max_age_filter }}æ­³ {% endif %}
            {% if not gender_filter and min_age_filter is none and max_age_filter is none %}**ãªã—** (å…¨ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º){% endif %}
        </div>
    </div>

    <h2>ğŸ“ˆ ç·åˆKPI (æ¤œç´¢çµæœ)</h2>
    <div class="kpi-container">
        <div class="kpi-box">
            <h3>ç·é¡§å®¢æ•°</h3>
            <div class="kpi-value">{{ total_customers | format_currency }}äºº</div>
        </div>
        <div class="kpi-box">
            <h3>ç·å£²ä¸Šé‡‘é¡</h3>
            <div class="kpi-value">Â¥{{ total_sales | format_currency }}</div>
        </div>
        <div class="kpi-box">
            <h3>å¹³å‡é¡§å®¢å˜ä¾¡ (ARPU)</h3>
            <div class="kpi-value">Â¥{{ avg_sales | format_currency }}</div>
        </div>
    </div>
    
    <h2>ğŸ… é¡§å®¢ãƒ©ãƒ³ã‚­ãƒ³ã‚° (æ¤œç´¢çµæœã«åŸºã¥ã)</h2>
    <div class="ranking-section">
        <div class="ranking-box">
            <h3>è³¼å…¥å›æ•° TOP 10</h3>
            <table>
                <thead>
                    <tr><th>é †ä½</th><th>é¡§å®¢ID</th><th>æ°å</th><th>å›æ•°</th></tr>
                </thead>
                <tbody>
                    {% for cust in top_freq %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ cust.customerid }}</td>
                        <td>{{ cust.lastname }} {{ cust.firstname }}</td>
                        <td>{{ cust.purchase_count | int }}å›</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="ranking-box">
            <h3>åˆè¨ˆè³¼å…¥é‡‘é¡ TOP 10</h3>
            <table>
                <thead>
                    <tr><th>é †ä½</th><th>é¡§å®¢ID</th><th>æ°å</th><th>é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    {% for cust in top_spend %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ cust.customerid }}</td>
                        <td>{{ cust.lastname }} {{ cust.firstname }}</td>
                        <td>Â¥{{ cust.total_spent | format_currency }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

  <script src="{{ url_for('static', filename='humberger.js') }}"></script>
</body>
</html>
